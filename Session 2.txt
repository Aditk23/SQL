use test;

SELECT * FROM EMP;
SELECT * FROM EMP_SAL;

SELECT EMP.EID, EMP.NAME, EMP.CITY, EMP_SAL.DEPT, EMP_SAL.DESI, EMP_SAL.SALARY
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;

SELECT E1.EID, E1.NAME,E1.CITY, E2.DEPT, E2.DESI, E2.SALARY
FROM EMP E1
INNER JOIN EMP_SAL E2
ON E1.EID=E2.EID;

SELECT EMP.EID, NAME, CITY, DEPT, DESI, SALARY
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;


SELECT EMP.EID, NAME, CITY, DEPT, DESI, SALARY
FROM EMP
LEFT JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;

SELECT EMP.EID, NAME, CITY, DEPT, DESI, SALARY
FROM EMP
RIGHT JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;


SELECT * FROM CJ1;
SELECT * FROM CJ2;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
INNER JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
FULL JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


SELECT * FROM CJ1;
SELECT * FROM CJ2;


SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
CROSS JOIN CJ2
WHERE  CJ1.RNO=CJ2.RNO;

-- CROSS JOIN + WHERE = INNER JOIN 


SELECT * FROM SJ;
SELECT * FROM BOSS;

SELECT SJ.ID, SJ.NAME, BOSS.NAME AS 'BOSSNAME'
FROM SJ
LEFT JOIN BOSS
ON SJ.BOSSID=BOSS.BID;


SELECT * FROM SJ;
SELECT * FROM SJ;

SELECT S1.ID, S1.NAME, S2.NAME AS 'BOSSNAME'
FROM SJ S1
LEFT JOIN SJ S2
ON S1.BOSSID=S2.ID;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO
UNION
SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

UNION ALL

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;


SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

INTERSECT 

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
LEFT JOIN CJ2
ON CJ1.RNO=CJ2.RNO

EXCEPT

SELECT CJ1.RNO, CJ1.NAME, CJ2.MARKS
FROM CJ1
RIGHT JOIN CJ2
ON CJ1.RNO=CJ2.RNO;

SELECT EID, NAME, CITY FROM EMP WHERE CITY='CHANDIGARH'
UNION
SELECT EID, NAME, CITY FROM EMP WHERE CITY='MUMBAI';


SELECT* FROM EMP WHERE CITY ='DELHI';

CREATE INDEX BI1 ON EMP (CITY);

DROP INDEX BI1 ON EMP;

SELECT* FROM EMP WHERE CITY ='DELHI' AND ADDRESS2 ='DWARKA';

-- COMPOSIT INDEX 

CREATE INDEX BI1 ON EMP (CITY, ADDRESS2);


-- IMPLICIT INDEX  - AUTOMITICALLY CREATED  - PRIMARY KEY / UNIQUE
-- EXPLICIT INDEX  - WE CREATE


-- CLUSTERED INDEX
-- NON CLUSTERED INDEX

CREATE CLUSTERED INDEX BI1 ON EMP (CITY);

DROP VIEW CH_EMP;
CREATE VIEW CH_EMP
AS
(	SELECT * FROM EMP
	WHERE CITY = 'CHANDIGARH');

SELECT * FROM CH_EMP;

INSERT INTO EMP
VALUES(1092,'GAGANDEEP SINGH', 'HNO 150 LANE 1', 'SECTOR 5', 'CHANDIGARH', '98111099876','GS92@GMAIL.COM', '10-01-1989','10-MAY-2020');

DELETE FROM EMP WHERE EID = 1092;

INSERT INTO CH_EMP
VALUES(1092,'GAGANDEEP SINGH', 'HNO 150 LANE 1', 'SECTOR 5', 'CHANDIGARH', '98111099876','GS92@GMAIL.COM', '10-01-1989','10-MAY-2020');


DELETE FROM CH_EMP WHERE EID = 1092;

INSERT INTO CH_EMP
VALUES(1092,'GAGANDEEP SINGH', 'HNO 150 LANE 1', 'SECTOR 5', 'CHANDIGARH', '98111099876','GS92@GMAIL.COM', '10-01-1989','10-MAY-2020');



CREATE VIEW CH_EMP
AS
	SELECT * FROM EMP
	WHERE CITY = 'CHANDIGARH'
	WITH CHECK OPTION ;

SELECT * FROM EMP;


CREATE VIEW EMP_DETAIL2
AS
	SELECT EID,  NAME, CITY, PHONENO, DOJ , EMAIL
	FROM EMP;

SELECT * FROM EMP_DETAIL2;

DROP VIEW ESAL_DEL;
CREATE VIEW ESAL_DEL
AS
SELECT EMP.EID, NAME, CITY, DOJ, DEPT, DESI, SALARY AS 'BASIC', SALARY *.15 AS 'HRA', SALARY * .09 AS 'PF'
FROM EMP
INNER JOIN EMP_SAL
ON EMP.EID=EMP_SAL.EID;


SELECT * FROM ESAL_DEL;

SELECT DISTINCT CITY FROM EMP;

CREATE VIEW SAL
AS

SELECT DEPT, SUM(SALARY) FROM EMP_SAL
GROUP BY DEPT;


SELECT COUNT (*) FROM EMP;
SELECT COUNT (EID) FROM EMP_SAL;
SELECT COUNT (SALARY) FROM EMP_SAL;

SELECT MAX(SALARY ) , MIN(SALARY) , SUM(SALARY) , AVG(SALARY) FROM EMP_SAL;

SELECT SQRT (16);

SELECT RAND();

SELECT CONCAT('HELLO ','WORLD');

SELECT * FROM EMP;

SELECT EID, NAME, CONCAT(ADDRESS1,' ', ADDRESS2,' ', CITY) AS 'ADDRESS' FROM EMP;

SELECT ASCII('A'), CHAR(65);

SELECT CHARINDEX('E','WELCOME');

SELECT LEFT ('WELCOME', 3);

SELECT RIGHT ('WELCOME', 3);

SELECT LEN('WELCOME');
SELECT LOWER('WELCOME');

SELECT SUBSTRING('WELCOME',4,3);

SELECT REVERSE('INDIA');

SELECT STUFF('ABCDEFGHIJ',3, 4,'XYZ');

SELECT EID, NAME ,  LEFT (NAME,CHARINDEX(' ', NAME)) AS 'FNAME',
RIGHT(NAME, (LEN(NAME)- CHARINDEX(' ', NAME))) AS 'LNAME'
FROM EMP;


SELECT GETDATE() , DATEADD(D,10, GETDATE()), DATEADD(M,10, GETDATE()), DATEADD(YY,2, GETDATE());

SELECT EID, NAME, DOJ , DATEADD(D, 90, DOJ) as 'CONFIRMATION DATE' FROM EMP;

SELECT EID, NAME, DOJ , DATEDIFF(YY, DOJ,GETDATE()) AS'TENURE'
FROM EMP;

SELECT DAY(GETDATE()) AS 'DAY', MONTH (GETDATE()) AS 'MONTH' , YEAR(GETDATE()) AS 'YEAR';
SELECT DATEPART(D, GETDATE())AS 'DAY',DATEPART(M, GETDATE())AS 'MONTYH', DATEPART(YY, GETDATE())AS 'YEAR';

SELECT GETDATE(),CONVERT (VARCHAR(20), GETDATE(), 110);

SELECT GETDATE(), FORMAT(GETDATE(),'D'), FORMAT(GETDATE(),'M'), FORMAT(GETDATE(),'Y');

SELECT * FROM EMP  
WHERE YEAR (DOJ)= 2020;
