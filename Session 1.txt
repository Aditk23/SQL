CREATE DATABASE LEARN8;

use learn8;

CREATE TABLE STU
(RNO INT,
NAME VARCHAR(25),
AGE INT);

INSERT INTO STU (RNO, NAME, AGE)
VALUES (1,'AJAY', 13);

INSERT INTO STU
VALUES(2,'KAPIL', 14);

INSERT INTO STU (RNO,NAME)
VALUES (3, 'JAY');

INSERT INTO STU (NAME, RNO, AGE)
VALUES('AMIT', 4, 14);

INSERT INTO STU
VALUES(5,'RAGHUVEER', 14);

SELECT RNO, NAME, AGE FROM STU;

SELECT * FROM STU;


USE TEST;

SELECT * FROM EMP
WHERE CITY ='DELHI';

-- LIKE - PATERN MATCHING % - ANY NO OF CHARACTERS  _  A SINGLE CHARACTER

SELECT * FROM EMP
WHERE NAME LIKE 'r%';

SELECT * FROM EMP
WHERE NAME LIKE '%SHARMA';

SELECT * FROM EMP
WHERE ADDRESS2 LIKE '%DWARKA%';

SELECT * FROM EMP
WHERE NAME LIKE 'R% KAPOOR';

SELECT * FROM EMP
WHERE NAME LIKE'____';

SELECT * FROM EMP
WHERE EMAIL LIKE '%@YAHOO%';

SELECT TOP 3 NAME FROM EMP;

USE LEARN8;

SELECT * FROM STU;

UPDATE STU SET AGE = 13
WHERE RNO=3;

DELETE FROM STU 
WHERE RNO=4;

DELETE FROM STU ;

DELETE STU
WHERE RNO=3;

DELETE STU;

ALTER TABLE STU
ADD CLASS CHAR(4);


ALTER TABLE STU
DROP COLUMN CLASS;


ALTER TABLE STU
ALTER COLUMN NAME VARCHAR(20);

SELECT * FROM STU;

UPDATE STU SET CLASS ='7TH';

DROP TABLE STU;

DROP DATABASE LEARN8;

TRUNCATE TABLE STU
WHERE RNO=5;
	
SELECT 5/2, 5%2;

USE TEST;

SELECT * FROM EMP_SAl
WHERE SALARY >=200000;


SELECT * FROM EMP_SAl
WHERE DEPT ='HR' AND SALARY >= 200000;

SELECT * FROM EMP_SAl
WHERE DEPT ='HR' OR SALARY >= 200000;

SELECT * FROM EMP_SAl
WHERE NOT DEPT = 'OPS';

SELECT * FROM EMP_SAl
WHERE DEPT <> 'OPS';


-- BETWEEN - RANGE

SELECT * FROM EMP_SAl
WHERE SALARY >= 100000 AND SALARY <= 200000;

SELECT * FROM EMP_SAl
WHERE SALARY BETWEEN 100000 AND 200000;

-- IN - LIST

SELECT * FROM EMP_SAl
WHERE DEPT = 'IT' OR DEPT='ADMIN' OR DEPT ='MIS';

SELECT * FROM EMP_SAl
WHERE DEPT IN ('MIS','IT','ADMIN');

-- IS NULL - CHECK FOR NULL VALUE

SELECT * FROM EMP_SAL
WHERE SALARY IS NULL;

-- DISTINCT  - UNIQUE VALUES OF A FILED

SELECT DISTINCT DEPT FROM EMP_SAL;

SELECT DISTINCT CITY FROM EMP;

USE LEARN8;


CREATE TABLE EMP
(EID CHAR(5),
NAME VARCHAR(20) NOT NULL,
ADDR VARCHAR(50),
CITY VARCHAR(30) DEFAULT 'DELHI',
PHONE CHAR(15) UNIQUE,
DOB DATE CHECK (DOB <= '01-JAN-1991'),
EMAIL VARCHAR(50),
PRIMARY KEY (EID));

INSERT INTO EMP (EID, ADDR, CITY, PHONE, DOB,EMAIL)
VALUES ('E0001', 'B5 JANAKPURI','DELHI','9899234567', '10-JAN-1990', 'ABC@GMAIL.COM');

INSERT INTO EMP (EID,NAME, ADDR, CITY, PHONE, DOB,EMAIL)
VALUES ('E0002', 'RAJAT SHARMA', 'DLF PHASE5','GURGAON','9899231100', '10-MAY-1987', 'ABCD@GMAIL.COM');

INSERT INTO EMP (EID,NAME, ADDR, PHONE, DOB,EMAIL)
VALUES ('E0003', 'MANOJ KUMAR', 'SECTOR 5 DWARKA','9900765006', '27-APR-1990', 'MK03@YAHOO.COM');

INSERT INTO EMP 
VALUES ('E0004', 'ROHAN SINGH', 'SECTOR 17','CHANDIGARH','9811167551', '20-APR-1925', 'ROHAN@YAHOO.CO.IN');

INSERT INTO EMP 
VALUES ('E0005', 'SANDEEP SHARMA', 'ROHINI','DELHI','9811454531', '20-APR-1989', 'SSHARMA@YAHOO.CO.IN');

INSERT INTO EMP 
VALUES ('E0006', 'GAURAV KAPOOR', 'UDYOG VIHAR PHASE 2','GURGAON','9811400011', '20-APR-1990', 'GK@GMAIL.COM');

INSERT INTO EMP 
VALUES ('E0007', 'RAMESH GUPTA', 'SECTOR 62','NOIDA','9811401234', '01-MAY-1989', 'RAMESH@GMAIL.COM');

SELECT * FROM EMP;

UPDATE EMP SET NAME = 'AJAY SHARMA';

UPDATE EMP SET DOB ='20-APR-1985' 
WHERE EID = 'E0004';
ALTER TABLE EMP
ALTER COLUMN NAME VARCHAR(20) NOT NULL;

ALTER TABLE EMP
ADD CONSTRAINT R1 DEFAULT 'DELHI' FOR CITY;

ALTER TABLE EMP
ADD CONSTRAINT UKPH UNIQUE (PHONE);

ALTER TABLE EMP
DROP CONSTRAINT R2;

ALTER TABLE EMP
ADD CONSTRAINT CKAGE CHECK (DOB <= '01-JAN-1991');

ALTER TABLE EMP
ALTER COLUMN EID CHAR(5) NOT NULL;

ALTER TABLE EMP
ADD CONSTRAINT PKID PRIMARY KEY (EID);
DROP TABLE EMP_SAL;

CREATE TABLE EMP_SAL
(EID CHAR(5) REFERENCES EMP (EID),
DEPT VARCHAR(20),
DESI VARCHAR(20),
DOJ DATE,
SALARY INT);

USE TEST;

SELECT COUNT (*) FROM EMP;
SELECT COUNT (NAME) FROM EMP;

SELECT COUNT (*) FROM EMP_SAL;
SELECT COUNT (SALARY) FROM EMP_SAL;

SELECT DISTINCT DEPT FROM EMP_SAL;

-- OREDR BY - SORTING


INSERT INTO EMP_SAL
VALUES ('E0010', 'OPS', 'DIRECTOR','01-MAR-2019', 400000);

INSERT INTO EMP_SAL
VALUES ('E0002', 'OPS', 'SR.MANAGER','01-APR-2019', 300000);


SELECT * FROM EMP;
SELECT * FROM EMP_SAL;

UPDATE EMP_SAL SET EID ='E0001';

ALTER TABLE EMP_SAL
ADD CONSTRAINT FKID FOREIGN KEY (EID) REFERENCES EMP (EID);

SELECT * FROM EMP_SAL
ORDER BY SALARY DESC;

SELECT DEPT, SUM(SALARY) AS'TOTALCOST'
FROM EMP_SAL
GROUP BY DEPT;

SELECT DEPT, DESI, SUM(SALARY) AS'TOTALCOST'
FROM EMP_SAL
GROUP BY DEPT , DESI;

SELECT  DESI, COUNT (EID) AS 'TEAMSIZE',SUM(SALARY) AS'TOTALCOST'
FROM EMP_SAL
GROUP BY DESI;


SELECT DEPT, SUM(SALARY) AS'TOTALCOST'
FROM EMP_SAL
GROUP BY DEPT
HAVING SUM(SALARY) >= 700000;


SELECT DEPT, COUNT (EID ) as 'TEAM SIZE', SUM(SALARY) AS'MANAGERCOST'
FROM EMP_SAL
WHERE DESI='MANAGER'
GROUP BY DEPT
HAVING SUM(SALARY)>=200000
ORDER BY 'MANAGERCOST' DESC;
